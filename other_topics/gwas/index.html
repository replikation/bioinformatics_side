<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>GWAS - Bioinformatics</title>
        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/color-brewer.min.css">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

        <script src="../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../js/bootstrap-3.0.3.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
            <div class="container">

                <!-- Collapsed navigation -->
                <div class="navbar-header">
                    <!-- Expander button -->
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="../..">Bioinformatics</a>
                </div>

                <!-- Expanded navigation -->
                <div class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Shell <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#">Basics/Hacking</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../shell/shell/">Commands</a>
</li>
            
<li >
    <a href="../../shell/shell_adv/">Cloud Computing</a>
</li>
            
<li >
    <a href="../../shell/ubuntu_server/">Ubuntu Server</a>
</li>
            
<li >
    <a href="../../shell/gpu/">GPUs</a>
</li>
    </ul>
  </li>
                                    
<li >
    <a href="../../shell/fasta/">File Manipulation (fasta)</a>
</li>
                                    
<li >
    <a href="../../shell/git/">Git</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Python <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../python/python/">Basics</a>
</li>
                                    
<li >
    <a href="../../python/bioconda/">Bioconda</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">R <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../R/R/">Basics</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#">Graphics</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../R/ggplot/">ggplot</a>
</li>
            
<li >
    <a href="../../R/distanceheatmap/">heatmap</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Tools <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../tools/atom/">Atom Editor</a>
</li>
                                    
<li >
    <a href="../../tools/emboss/">EMBOSS</a>
</li>
                                    
<li >
    <a href="../../tools/mkdocs/">mkdocs</a>
</li>
                                    
<li >
    <a href="../../tools/UGENE/">UGENE</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Sequencing <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../sequencing/programs/">Programs</a>
</li>
                                    
<li >
    <a href="../../sequencing/illumina/">HTS (Illumina)</a>
</li>
                                    
<li >
    <a href="../../sequencing/nanopore/">Longreads (Nanopore)</a>
</li>
                                    
<li >
    <a href="../../sequencing/hybrid/">Hybridassembly</a>
</li>
                                    
<li >
    <a href="../../sequencing/annotation/">Annotation</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Metagenome <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../metagenome/metagenomics/">Metagenomics</a>
</li>
                                    
<li >
    <a href="../../metagenome/metabarcoding/">Metabarcoding</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Docker <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../docker/docker/">Docker-Basics</a>
</li>
                                    
<li >
    <a href="../../docker/win_docker/">Docker in Win</a>
</li>
                                    
<li >
    <a href="../../docker/gpu/">GPU_Docker</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Other Topics <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../databases/">Databases</a>
</li>
                                    
<li class="active">
    <a href="./">GWAS</a>
</li>
                                    
<li >
    <a href="../gs/">GS</a>
</li>
                                    
<li >
    <a href="../RNA_seq/">RNA seq</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Congress <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../congress/LR_2019/">2019</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li >
                                <a rel="next" href="../databases/">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li >
                                <a rel="prev" href="../gs/">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#gwas-genome-wide-association-study">GWAS (Genome wide association study)</a></li>
            <li><a href="#qtl-quantitative-trait-locus">QTL (quantitative trait locus)</a></li>
            <li><a href="#qc-of-snp-genotyping">QC of SNP Genotyping</a></li>
            <li><a href="#signifikant-snp-results-and-qc">Signifikant SNP results and QC</a></li>
            <li><a href="#plink-software-practical">PLINK (Software) - practical</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="gwas-genome-wide-association-study">GWAS (Genome wide association study)</h1>
<h2 id="qtl-quantitative-trait-locus">QTL (quantitative trait locus)</h2>
<ul>
<li>More than one gene is responsible for certain traits</li>
<li>genes can interact <strong>between</strong> loci (epistatic effects) or <strong>within</strong> the loci (dominance effects)</li>
<li><strong>QTL</strong> is a section of DNA (locus) which correlates with a variation in a phenotype</li>
<li>it is linked to, or contains, the genes which control that phenotype</li>
<li>QTLs are mapped by identifying which SNPs correlate with an observed trait</li>
<li>one QTL can affect multiple traits, and can be dominant or recessive</li>
</ul>
<h3 id="how-to-identify-qtls">How to identify QTLs</h3>
<table>
<thead>
<tr>
<th>1. QTL/Linkage Mapping</th>
<th>2. GWAS (newer)</th>
</tr>
</thead>
<tbody>
<tr>
<td>study pop. is families or experimental crosses</td>
<td>uses a population sample</td>
</tr>
<tr>
<td>hundreds of DNA markers</td>
<td>Tens of thousands DNA marker</td>
</tr>
<tr>
<td>Current recombinations</td>
<td>historical recombinations</td>
</tr>
</tbody>
</table>
<p><strong>Linkage disequilibrium (LD)</strong>
(non random association of allels between locis, LD "decays" - the faster the decay the higher the marker density has to be)</p>
<p><strong>Pro</strong>: can scan genome with fewer markers</p>
<p><strong>Cons</strong>: Can only detect alleles with large effect; limited resolution (identify broad region, not individual genes); requires data on multiple family members</p>
<p><strong>Association (GWAS)</strong></p>
<p><strong>Pros</strong>: can detect subtle effects; very fine resolution</p>
<p><strong>Cons</strong>: requires 0.5 to 1 million markers to cover whole genome; requires large sample size</p>
<h4 id="1-qtllinkage-mapping-inferior-to-gwas">1. QTL/Linkage Mapping (inferior to GWAS)</h4>
<ul>
<li>Determining the location of a gene in the genome</li>
<li>Estimating the effects of the alleles and mode of action</li>
<li>Individuals inherit different marker variants</li>
<li>Individuals vary according to their marker genotype</li>
<li>You have to know what you are looking for (e. g. certain diseases)</li>
<li>Costly since you have to analyze each generation (good for disease reconstructions)</li>
<li>The QTL has to be inferred from knowledge and prediction (e. g. color of the fur/hide)</li>
</ul>
<p>For QTL Linkage Mapping you need:</p>
<blockquote>
<ul>
<li>Well recorded population with high quality DNA samples</li>
<li>DNA Markers across the genome</li>
<li>Map of Marker positions</li>
<li>High quality genotype</li>
</ul>
</blockquote>
<h4 id="2-gwas-best-method">2. GWAS (best method)</h4>
<ul>
<li>In genetics, a <strong>genome-wide association study</strong> (<strong>GWAS</strong>), is an observational study of a genome-wide set of genetic variants in different individuals to see if ==any variant is associated with a trait==</li>
<li>GWASs typically focus on associations between SNPs and traits (e.g. SNPs associated with milk production)
a) Take a large (thousands), representative, sample of the population
b) Characterised for a very large number of DNA variants
c) Estimate a putative effect of every DNA variant on the trait of interest</li>
</ul>
<h2 id="qc-of-snp-genotyping">QC of SNP Genotyping</h2>
<h3 id="for-samples">For samples</h3>
<ul>
<li>Blind duplicates</li>
<li>genders</li>
<li>unsuspected twinning or cryptic relatedness</li>
<li>DNA degradation or fragmentation</li>
<li>Call rate (&gt; 80-90%)</li>
<li>Heterozygosity: outliers, Plate/batch calling effects</li>
</ul>
<h3 id="for-snps">For SNPs</h3>
<ul>
<li>Duplicate concordance (CEPH samples)</li>
<li>Mendelian errors (typically &lt; 1)</li>
<li>Hardy-Weinberg errors (often &gt; 10-5 )</li>
<li>Heterozygosity (outliers)</li>
<li>Call rate (typically &gt; 98%)</li>
<li>Minor allele frequency (often &gt; 1%)</li>
<li>Validation of most critical results on independent genotyping platform</li>
</ul>
<p><strong>Association analysis is often quickest way to find genotyping errors (PLINK)</strong></p>
<h2 id="signifikant-snp-results-and-qc">Signifikant SNP results and QC</h2>
<ul>
<li>signifikant results in an manhatten plot or a Q-Q plot</li>
<li>A significant marker associated with a QT does not imply a causative <strong>quantitative trait nucleotide</strong> (QTN)</li>
<li>significant result indicates:<ul>
<li>The marker is in linkage disequilibrium with a QTN</li>
<li>false positive result: by chance or due to <strong>Population stratification</strong></li>
</ul>
</li>
<li>positive results have to be backed up with functional data and/or a replication study in a different population</li>
</ul>
<h3 id="problems-that-bias-you-results-confounding-factors">Problems that bias you results (confounding factors)</h3>
<ul>
<li>SNPs can correlate with latent variables</li>
<li>the variables can have an effect!</li>
<li>SNP then gives <strong>false positive result</strong></li>
<li>Examples:<ul>
<li>Population structure Admixture</li>
<li>breed or even family</li>
<li>Geographical effects</li>
<li>Batch effects</li>
</ul>
</li>
</ul>
<p><strong>Solutions:</strong>
a) Genomic control - inflating factor to control p values
b) Structure - estimate a population structure
c) Principle components - genome wide IBS matrix (in Plink its the <code>--cluster</code> command)</p>
<h2 id="plink-software-practical">PLINK (Software) - practical</h2>
<ul>
<li>whole genome wide association (GWAS) analysis tool</li>
<li>Install by google PLINK and get the precompiled *.zip file. <code>mv plink ~/.local/bin</code>, done</li>
</ul>
<p><strong>The workflow is usually:</strong>
 1. Plan the study (choose design to target your hypothesis)
 2. Collect data (based on design, number of markers)
 3. Remove problematic data
 4. Identify other pedigree related problems (population stratification)
 5. Association analysis
 6. Correction of results to minimize false positives
 7. further validation of the region (e. g. identify possible genes)</p>
<h3 id="correction-and-binary-file-creation">Correction and binary file creation</h3>
<h4 id="without-phenotype-file">Without phenotype file</h4>
<ul>
<li>using <code>.ped</code> and <code>.map</code> files<ul>
<li><code>--ped wolf.ped</code> and <code>--map wolf.map</code></li>
<li><code>.ped</code> contains Family-, Individual-, Paternal-, Maternal-ID, Sex and phenotype</li>
<li><code>.map</code> contains chromosome, rs# or snp identifier, Genetic distance (morgans) and bp position</li>
</ul>
</li>
<li>we correct the individuals and SNPs with the flags: <code>--geno 0.25 --maf 0.05 --mind 0.25</code></li>
<li>we use the <code>--dog</code> flag (or <code>--cow</code>)</li>
<li><code>--out</code> specifies outputname, ==NEVER CHANGE IT== unless written and highlighted here</li>
<li>we save the data also in binary using the <code>--make-bed</code>; this creates 3 files:<ul>
<li><code>wolf.bed</code>, <code>wolf.fam</code> and <code>wolf.bin</code></li>
<li>these files are now used with <code>--bfile wolf</code> so <code>--ped, --map, --geno, --maf, --mind</code> fall away</li>
</ul>
</li>
</ul>
<pre><code>plink --ped wolf.ped --map wolf.map --out wolf --geno 0.25 --maf 0.05 --mind 0.25 --dog --noweb --allow-no-sex --make-bed
</code></pre>

<ul>
<li>this creates a log file: <code>wolf.log</code><ul>
<li>states amount of ==individuals== and how many excluded</li>
<li>states how many ==SNPs== are included/excluded</li>
</ul>
</li>
</ul>
<h3 id="with-phenotype-file">With phenotype file</h3>
<ul>
<li>same command and usage as above, but we add the flag <code>--no-pheno</code> and the flag/file <code>--pheno cow.phe</code> to the command</li>
<li>example with cow data:</li>
</ul>
<pre><code class="bash">plink --ped cow.ped --map cow.map --out cow --geno 0.25 --maf 0.05 --mind 0.25 --cow --noweb --allow-no-sex --make-bed --no-pheno --pheno cow.phe
</code></pre>

<h3 id="various-analysises">Various analysises</h3>
<p><code>--freq</code> - Allel frequency, creates a <code>.frq</code> file
<code>--missing</code> -
<code>--hardy</code> -
<code>--asso</code> -
* add a flag to this basic command:</p>
<pre><code class="bash">plink --bfile wolf --out wolf --dog --noweb --allow-no-sex
</code></pre>

<h3 id="population-stratification">Population stratification</h3>
<ul>
<li>used to check if you may have more than one population (pedigree related problems), details <a href="https://www.cog-genomics.org/plink/1.9/strat#mds_plot">here</a></li>
<li>creating a 2D-MDS plot (more under <strong>09 - "β diversity analysis"</strong>)</li>
</ul>
<pre><code class="bash"> plink --bfile wolf --out wolf --dog --noweb --allow-no-sex --cluster --mds-plot 2
</code></pre>

<p><strong>Plotting in excel, we see 3 distinct populations:</strong>
<img alt="" src="https://i.imgur.com/0RJdPBR.png" /></p>
<h3 id="basic-reports-casecontrol-phenotype">Basic reports, case/control phenotype</h3>
<ul>
<li>for this to work you need the additional phenotype datafile <code>.phe</code></li>
<li>see also <a href="https://www.cog-genomics.org/plink/1.9/assoc#model">here</a></li>
<li>first correcting the results (p-values) for multiple testing with 10,000 permutations which creates an <code>.assoc</code> and <code>.assoc.mperm</code> file:</li>
</ul>
<pre><code>plink --bfile cow --allow-no-sex --cow --out cow --assoc --noweb --mperm 10000 --no-pheno --pheno cow.phe
</code></pre>

<ul>
<li>adjustment of results (e. g. Bonferroni adjusted significance value)</li>
<li><strong>change the <code>--out</code> to something else</strong></li>
</ul>
<pre><code class="bash">plink --bfile cow --allow-no-sex --cow --out cow2 --assoc --noweb --adjust
</code></pre>

<ul>
<li>use the new file <code>cow2.qassoc</code> for plotting</li>
</ul>
<h3 id="ploting-the-data">Ploting the data</h3>
<ul>
<li>Using manhatten plot, install with <code>install.packages("qqman")</code></li>
<li>the <code>sep=""</code> of read.table threats multiple space as one</li>
</ul>
<pre><code class="R">library(qqman)
x &lt;- read.table(&quot;cow2.qassoc&quot;, sep=&quot;&quot;, header = TRUE)
manhattan(x, chr=&quot;CHR&quot;, bp=&quot;BP&quot;, snp=&quot;SNP&quot;, p=&quot;P&quot;)
</code></pre>

<ul>
<li>to highlight SNPs of interest add <code>, highlight= y</code> to the manhatten command, y is this:</li>
</ul>
<pre><code class="R">y &lt;- c(&quot;rs3001&quot;, &quot;SNP205&quot;, &quot;rs3003&quot;)
</code></pre>

<ul>
<li>search via excel the <code>.qassoc</code> for SNPs of interest (closer to 0 the more significant so smaller than 1e⁻⁷), see line above blue in the plot</li>
</ul>
<p><strong>Results:</strong>
* check <a href="http://www.gettinggeneticsdone.com/2014/05/qqman-r-package-for-qq-and-manhattan-plots-for-gwas-results.html">this</a> out for how to get GWAS into a plot or this figure
<img alt="" src="https://i.imgur.com/dMvRGGi.png" /></p></div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../..",
                shortcuts = {"previous": 80, "next": 78, "help": 191, "search": 83};
        </script>
        <script src="../../js/base.js" defer></script>
        <script src="../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
