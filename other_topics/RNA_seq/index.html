<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>RNA seq - Bioinformatics</title>
        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/color-brewer.min.css">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

        <script src="../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../js/bootstrap-3.0.3.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
            <div class="container">

                <!-- Collapsed navigation -->
                <div class="navbar-header">
                    <!-- Expander button -->
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="../..">Bioinformatics</a>
                </div>

                <!-- Expanded navigation -->
                <div class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Shell <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#">Basics/Hacking</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../shell/shell/">Commands</a>
</li>
            
<li >
    <a href="../../shell/shell_adv/">Cloud Computing</a>
</li>
            
<li >
    <a href="../../shell/ubuntu_server/">Ubuntu Server</a>
</li>
            
<li >
    <a href="../../shell/gpu/">GPUs</a>
</li>
    </ul>
  </li>
                                    
<li >
    <a href="../../shell/fasta/">File Manipulation (fasta)</a>
</li>
                                    
<li >
    <a href="../../shell/git/">Git</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Python <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../python/python/">Basics</a>
</li>
                                    
<li >
    <a href="../../python/bioconda/">Bioconda</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">R <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../R/R/">Basics</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#">Graphics</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../R/ggplot/">ggplot</a>
</li>
            
<li >
    <a href="../../R/distanceheatmap/">heatmap</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Tools <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../tools/atom/">Atom Editor</a>
</li>
                                    
<li >
    <a href="../../tools/emboss/">EMBOSS</a>
</li>
                                    
<li >
    <a href="../../tools/mkdocs/">mkdocs</a>
</li>
                                    
<li >
    <a href="../../tools/UGENE/">UGENE</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Sequencing <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../sequencing/programs/">Programs</a>
</li>
                                    
<li >
    <a href="../../sequencing/illumina/">HTS (Illumina)</a>
</li>
                                    
<li >
    <a href="../../sequencing/nanopore/">Longreads (Nanopore)</a>
</li>
                                    
<li >
    <a href="../../sequencing/hybrid/">Hybridassembly</a>
</li>
                                    
<li >
    <a href="../../sequencing/annotation/">Annotation</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Metagenome <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../metagenome/metagenomics/">Metagenomics</a>
</li>
                                    
<li >
    <a href="../../metagenome/metabarcoding/">Metabarcoding</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Docker <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../docker/docker/">Docker-Basics</a>
</li>
                                    
<li >
    <a href="../../docker/win_docker/">Docker in Win</a>
</li>
                                    
<li >
    <a href="../../docker/gpu/">GPU_Docker</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Other Topics <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../databases/">Databases</a>
</li>
                                    
<li >
    <a href="../gwas/">GWAS</a>
</li>
                                    
<li >
    <a href="../gs/">GS</a>
</li>
                                    
<li class="active">
    <a href="./">RNA seq</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#">Congress</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../congress/LR_2019/">2019_LRM</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li >
                                <a rel="next" href="../gs/">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li >
                                <a rel="prev" href="../../congress/LR_2019/">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#rnaseq">RNAseq</a></li>
            <li><a href="#overview">Overview</a></li>
            <li><a href="#differential-expression-practical">Differential Expression - practical</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="rnaseq">RNAseq</h1>
<h2 id="overview">Overview</h2>
<ul>
<li>identifying novel transcripts and splicing variants</li>
<li>Measuring gene expression (cellular identity, expression in response to stimuli, differences between health/sick, correlation to diseases, etc.)</li>
<li>microRNA's, RNA editing</li>
<li>low background noise, high technical reproducibility</li>
</ul>
<h3 id="typical-rnaseq-workflow">Typical RNAseq workflow</h3>
<p><strong>Questions:</strong></p>
<p><em>Quantification</em>: Expression rates</p>
<p><em>Splicing variants</em>: exon arrangements</p>
<p><em>Novel transcripts</em></p>
<p><em>RNA editing</em>: single nucleotide variations (SNV)</p>
<p><strong>Practical:</strong>
 1. poly-A RNA extraction (mRNA extraction Kit)
 2. reverse transcription into c-DNA
 3. shearing (for illumina, not for nanopore)
 4. library prep (depends on which seq. technique)
 5. sequencing and getting the reads (fastq)</p>
<p><strong>Bioinformatics:</strong>
 1. <strong>Preprocessing</strong> fastq files using: <code>Trimmomatic, cutadapt, trimgalore</code>
    1. adapter removal
    2. trimming of bad quality
 2. <strong>Mapping</strong>
     1. no genome: <em>de novo</em> transcriptom construction
     2. known genome: align reads against it
         1. <em>Quantification</em>: accept only known/described transcripts
         2. <em>Splicing variants</em>: allow alternate arrangements of known transcripts
         3. <em>Novel transcripts</em>: allow alignment to exons and other regions
 3. <strong>Mapping QC</strong> with <code>RNA-SeQC</code>, discard reads if:
    1. cannot be uniquely mapped
    2. alignment overlaps with several genes
    3. bad alignment quality score
    4. paired-end reads (illumina) do not map to the same genes
 4. <strong>Expression Quantification</strong> (normalization of read counts)
    1. correct read length bias (longer genes produce more reads)
    2. correct Batch effects (labs and preparation time - different coverage between samples)
    3. correct technical biases (use of different machines)</p>
<h3 id="types-of-normalization">Types of normalization</h3>
<p>You need to know:
<em> How was RNA extracted and the library build
</em> Which Sequencing platform
<em> single or basepaired ends?
</em> How many reads per sample?
* QC reports?</p>
<p>Normalization for: <strong>library size</strong>, <strong>gene length</strong>, <strong>RNA composition</strong> (comparison between samples)
* Methods:
    * RPKM/FPKM (size and length)
        * not recommended if you compare between different samples
        * <strong>R</strong>eads <strong>p</strong>er <strong>k</strong>ilo base per <strong>m</strong>illion mapped reads (RPKM)
        * use only to report expression values NOT differential expression
    * TPM (size and length)
        * similar to RPKM but uses <strong>t</strong>ranscripts instead of reads
        * the presenter doesn't use this method
    * TMM and DESeq (size and composition)
        * TMM considers the tissue type expression variation
        * suitable for differential expression between sample groups</p>
<p><strong>Data visualization is done with MA-plot or vulcano plot</strong>(check the tutorial afterwards)</p>
<blockquote>
<p><img alt="" src="https://raw.githubusercontent.com/wiki/trinityrnaseq/trinityrnaseq/images/MA_and_volcano_plot.png" />
Figure: Black is not significant, red are significant changes
<em> heatmaps is the most common representation for differential expression analysis (R/Bioconducter heatmap and ggplot package)
</em> Another way to see how samples cluster is with PCA plots</p>
</blockquote>
<p>Function enrichment analysis:
<em> GOSeq/topGO/GAGE (R package)
</em> <a href="https://david.ncifcrf.gov/">DAVID</a></p>
<h2 id="differential-expression-practical">Differential Expression - practical</h2>
<p>For this tutorial we used the test data from <a href="http://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1004393">this paper</a>. This is a highly comprehensive tutorial paper for RNAseq.</p>
<p><strong>Summary:</strong></p>
<blockquote>
<ul>
<li>We have two <strong>two commercially available RNA samples</strong>:</li>
<li>Universal Human Reference (UHR)<ul>
<li>10 cancer cell lines</li>
</ul>
</li>
<li>Human Brain Reference (HBR)<ul>
<li>isolated from brains of 23 Caucasians (m &amp; f) mostly 60-80 years old</li>
</ul>
</li>
<li>
<p><strong>a spike-in control was added to each sample</strong> (ERCC ExFold RNA). <strong>Spike-in consists of 92 transcripts</strong> that are present in known concentrations across a wide abundance range (from very few copies to many copies). This <strong>allows to test</strong> the degree to which the <strong>RNA-seq assay</strong> (including all laboratory and analysis steps) accurately <strong>reflects the relative abundance</strong> of transcript species within a sample</p>
</li>
<li>
<p><strong>two 'mixes' of spike-in control</strong> to allow assessment of differential expression output between samples</p>
</li>
<li>
<p><strong>3 complete experimental replicates</strong> for each sample to assess the technical variability of our overall process of producing RNA-seq data in the lab</p>
</li>
<li>
<p>UHR + ERCC Spike-In Mix1, Replicate 1</p>
</li>
<li>UHR + ERCC Spike-In Mix1, Replicate 2</li>
<li>UHR + ERCC Spike-In Mix1, Replicate 3</li>
<li>HBR + ERCC Spike-In Mix2, Replicate 1</li>
<li>HBR + ERCC Spike-In Mix2, Replicate 2</li>
<li>HBR + ERCC Spike-In Mix2, Replicate 3</li>
<li>For technical details, like Kits, rRNA removal, sample concentrations etc. read the <a href="https://doi.org/10.1371/journal.pcbi.1004393.s002">S2 Data</a> file from the paper.</li>
</ul>
</blockquote>
<p>Data available at:</p>
<pre><code class="bash">curl -O -J -L https://osf.io/7zepj/download
tar xzf toy_rna.tar.gz
</code></pre>

<h3 id="salmon-for-indexing-and-quantification-of-reads"><code>salmon</code> for indexing and quantification of reads</h3>
<ul>
<li>Salmon produces highly-accurate, transcript-level quantification estimates from RNA-seq data (you need another - splice aware program - if you are interested in new transcripts or splice sides.</li>
</ul>
<p><strong>Quantify reads with <code>salmon</code></strong></p>
<ul>
<li>First Indexing:</li>
</ul>
<pre><code class="bash">salmon index -t chr22_transcripts.fa -i chr22_index
</code></pre>

<ul>
<li>Now quantifying with this loop:</li>
<li>simply goes through each sample and invokes salmon using basic options:</li>
<li><code>-i</code> index file from the command before</li>
<li><code>--libType</code> A tells salmon that it should automatically determine the library type of the sequencing reads (e.g. stranded vs. not stranded etc.)</li>
<li>the -1 and -2 arguments tell salmon where to find the left and right reads for this sample (salmon accepts gzipped FASTQ files)</li>
<li><code>-o</code> output</li>
</ul>
<pre><code class="bash">for i in *_R1.fastq.gz
do
   prefix=$(basename $i _R1.fastq.gz)
   salmon quant -i chr22_index --libType A \
          -1 ${prefix}_R1.fastq.gz -2 ${prefix}_R2.fastq.gz -o quant/${prefix};
done
</code></pre>

<ul>
<li>in the output folder (quant folder) is the quant.sf file we use for Rstudio.</li>
</ul>
<h3 id="r-studio-analysis">R-studio analysis</h3>
<ul>
<li>In R-studio set your working directory to the data (chr22_genes.gtf is visible)</li>
<li>load the necessary modules</li>
</ul>
<pre><code class="R">library(tximport)
library(GenomicFeatures)
library(readr)
</code></pre>

<ul>
<li>Salmon did the quantification of the transcript level. We want to see which genes are differentially expressed, so we need to link the transcript names to the gene names. We can use our .gtf annotation for that, and the GenomicFeatures package:</li>
</ul>
<pre><code class="R">txdb &lt;- makeTxDbFromGFF(&quot;chr22_genes.gtf&quot;)
k &lt;- keys(txdb, keytype = &quot;TXNAME&quot;)
tx2gene &lt;- select(txdb, keys = k, keytype = &quot;TXNAME&quot;, columns = &quot;GENEID&quot;)
</code></pre>

<ul>
<li>Now we can import the salmon quantification.</li>
</ul>
<pre><code class="R"># we imported a file were each sample name is stored under the column &quot;sample&quot;
    samples &lt;- read.table(&quot;samples.txt&quot;, header = TRUE)
# we save the path to each quant.sf file using the name of each sample in the samples file
    files &lt;- file.path(&quot;quant&quot;, samples$sample, &quot;quant.sf&quot;)
# we renamed the columns name of each path we extracted
    names(files) &lt;- paste0(samples$sample)
# imports the quant files, txi.salmon is a datalist e.g. salmon$counts for the counts list-entry
    txi.salmon &lt;- tximport(files, type = &quot;salmon&quot;, tx2gene = tx2gene)
</code></pre>

<p><strong>Differential expression using DESeq2</strong>
+ <code>DESeqDataSet</code> is a subclass of <code>RangedSummarizedExperiment</code>, used to store the input values, intermediate calculations and results of an <strong>analysis of differential expression</strong>.</p>
<pre><code class="R">library(DESeq2) #loading module
</code></pre>

<ul>
<li>Instantiate the DESeqDataSet and generate result table. See <code>?DESeqDataSetFromTximport</code> and <code>?DESeq</code> for more information.</li>
</ul>
<pre><code class="R">dds &lt;- DESeqDataSetFromTximport(txi.salmon, samples, ~condition)
dds &lt;- DESeq(dds)
res &lt;- results(dds) #summary(res) to see the results
</code></pre>

<ul>
<li>DESeq uses a negative binomial distribution. Such distributions have two parameters: <strong>mean</strong> and <strong>dispersion</strong>.</li>
<li>So we can do a dispersion plot with the dispersion data:</li>
</ul>
<pre><code class="R">plotDispEsts(dds, main=&quot;Dispersion plot&quot;)
</code></pre>

<ul>
<li>Explanations about dispersion and DESeq2 can be found in this very good tutorial <a href="https://hbctraining.github.io/DGE_workshop/lessons/04_DGE_DESeq2_analysis.html">here</a>.</li>
</ul>
<blockquote>
<p><img alt="" src="https://i.imgur.com/4q4cmxH.png" />
Figure:  The red line in the figure plots the estimate for the <strong>expected dispersion value for genes of a given expression strength</strong>. Each black dot is a gene with an associated mean expression level and maximum likelihood estimation (MLE) of the dispersion.</p>
</blockquote>
<hr />
<p><strong>Heatmap</strong>
* For clustering and heatmaps, we need to log transform our data:</p>
<pre><code class="R">rld &lt;- rlogTransformation(dds) #log of data from &quot;dds&quot;
#loading librarys for plot
library(RColorBrewer)
library(gplots)
</code></pre>

<ul>
<li>parameters of the heatmap:</li>
</ul>
<pre><code class="R">(mycols &lt;- brewer.pal(8, &quot;Dark2&quot;)[1:length(unique(samples$condition))])
sampleDists &lt;- as.matrix(dist(t(assay(rld))))
heatmap.2(as.matrix(sampleDists), key=F, trace=&quot;none&quot;,
          col=colorpanel(100, &quot;black&quot;, &quot;white&quot;),
          ColSideColors=mycols[samples$condition],
          RowSideColors=mycols[samples$condition],
          margin=c(10, 10), main=&quot;Sample Distance Matrix&quot;)
</code></pre>

<blockquote>
<p><img alt="" src="https://i.imgur.com/i6NEzsu.png" />
Figure: Differential Expression Analysis: Comparison between each samples as a heatmap, black is identical, white not identical</p>
</blockquote>
<hr />
<p><strong>PCA Plot</strong></p>
<pre><code class="R">DESeq2::plotPCA(rld, intgroup=&quot;condition&quot;)
</code></pre>

<p><img alt="" src="https://i.imgur.com/HOizOAe.png" /></p>
<hr />
<p><strong>MA plot and the Volcano Plot</strong></p>
<ul>
<li>we create, merge and sort data, so its readable for the plots</li>
</ul>
<pre><code class="R">table(res$padj&lt;0.05) #extract data out of res
res &lt;- res[order(res$padj), ] #sorting the res variable
#merging data so its ready for plots
resdata &lt;- merge(as.data.frame(res), as.data.frame(counts(dds, normalized=TRUE)), by=&quot;row.names&quot;, sort=FALSE)
names(resdata)[1] &lt;- &quot;Gene&quot;
</code></pre>

<ul>
<li>You can take a look at the p-values we sorted in the variable <code>res</code>, using these plots:</li>
</ul>
<pre><code class="R">hist(res$pvalue, breaks=50, col=&quot;grey&quot;) #a hist plot
DESeq2::plotMA(dds, ylim=c(-1,1), cex=1) #an MA plot
</code></pre>

<ul>
<li>now we do the actual vulcano plot</li>
</ul>
<pre><code class="R"># Volcano plot
with(res, plot(log2FoldChange, -log10(pvalue), pch=20, main=&quot;Volcano plot&quot;, xlim=c(-2.5,2)))
# second one highlighting certain points
with(subset(res, padj&lt;.05 ), points(log2FoldChange, -log10(pvalue), pch=20, col=&quot;red&quot;))
</code></pre>

<hr />
<h3 id="kegg-pathway-analysis">KEGG pathway analysis</h3>
<p><strong>KEGG PATHWAY</strong> is a collection of manually drawn <a href="http://www.genome.jp/kegg/kegg3a.html">pathway maps</a> representing our knowledge on the molecular interaction, reaction and relation networks for:
* We need these library's:</p>
<pre><code class="R">library(AnnotationDbi)
library(org.Hs.eg.db)
library(pathview)
library(gage)
library(gageData)
</code></pre>

<ul>
<li>Using the <code>mapIds</code> function to add more columns to the results</li>
<li>the row.names of our results table has the Ensembl gene ID (our key), so we need to specify <code>keytype=ENSEMBL</code></li>
<li>the column argument tells the <code>mapIds</code> function which information we want</li>
<li>the <code>multiVals</code> argument tells the function what to do if there are multiple possible values for a single input value (we take only the first entry if we have more than two)</li>
</ul>
<pre><code class="R">res$symbol &lt;- mapIds(org.Hs.eg.db, keys=row.names(res), column=&quot;SYMBOL&quot;, keytype=&quot;ENSEMBL&quot;, multiVals=&quot;first&quot;)
res$entrez &lt;- mapIds(org.Hs.eg.db, keys=row.names(res), column=&quot;ENTREZID&quot;, keytype=&quot;ENSEMBL&quot;, multiVals=&quot;first&quot;)
res$name &lt;- mapIds(org.Hs.eg.db, keys=row.names(res), column=&quot;GENENAME&quot;, keytype=&quot;ENSEMBL&quot;, multiVals=&quot;first&quot;)
</code></pre>

<ul>
<li>We’re going to use the <a href="https://bioconductor.org/packages/release/bioc/html/gage.html">gage</a> package for pathway analysis, and the <a href="https://bioconductor.org/packages/release/bioc/html/pathview.html">pathview</a> package to draw a pathway diagram.</li>
<li>The gageData package has pre-compiled databases mapping genes to KEGG pathways and GO terms for common organisms:</li>
</ul>
<pre><code class="R">data(kegg.sets.hs)
data(sigmet.idx.hs)
kegg.sets.hs &lt;- kegg.sets.hs[sigmet.idx.hs]
head(kegg.sets.hs, 3)
</code></pre>

<ul>
<li>Run the pathway analysis</li>
</ul>
<pre><code class="R">foldchanges &lt;- res$log2FoldChange
names(foldchanges) &lt;- res$entrez
keggres &lt;- gage(foldchanges, gsets=kegg.sets.hs, same.dir=TRUE)
lapply(keggres, head)
</code></pre>

<ul>
<li>Now we need to identify which pathway we have and whats the ID of it:</li>
</ul>
<pre><code class="R">library(dplyr)
# Get the pathways
keggrespathways &lt;- data.frame(id=rownames(keggres$greater), keggres$greater) %&gt;%
  tbl_df() %&gt;%
  filter(row_number()&lt;=5) %&gt;%
  .$id %&gt;%
  as.character()
keggrespathways
# Get the IDs.
keggresids &lt;- substr(keggrespathways, start=1, stop=8)
</code></pre>

<ul>
<li>Finally, the <code>pathview()</code> function in the pathview package makes the plots. Let’s write a function so we can loop through and draw plots for the top 5 pathways we created above.</li>
</ul>
<pre><code class="R"># Define plotting function for applying later
    plot_pathway &lt;- function(pid) pathview(gene.data=foldchanges, pathway.id=pid, species=&quot;hsa&quot;, new.signature=FALSE)

# Unload dplyr since it conflicts with the next line
    detach(&quot;package:dplyr&quot;, unload=T)
# plot multiple pathways (plots saved to disk andreturns a throwaway list object)
    tmp &lt;- sapply(keggresids, function(pid) pathview(gene.data=foldchanges, pathway.id=pid, species=&quot;hsa&quot;))
</code></pre>

<p><strong>The results are shown here (but only for 2 pathways and only the KEGG output):</strong></p>
<blockquote>
<p><img alt="" src="https://i.imgur.com/5MJxT3b.png" />
<img alt="" src="https://i.imgur.com/6jWXmGt.png" /></p>
</blockquote>
<p>Another tutorial about this pathway stuff can be found <a href="http://www.gettinggeneticsdone.com/2015/12/tutorial-rna-seq-differential.html">here</a>.</p></div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "previous": 80, "next": 78, "search": 83};
        </script>
        <script src="../../js/base.js" defer></script>
        <script src="../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
